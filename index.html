<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IRINDIRO FOOTBALL CLUB</title>
  <style>
    /* Your complete style.css content here - paste the full CSS from your style.css file */
    body { font-family: 'Times New Roman', Times, serif; margin: 0; padding: 0; background: #dbeafe; color: #333; }
    header { text-align: center; padding: 20px; background: #047857; color: white; }
    header img { width: 120px; height: 120px; border-radius: 50%; margin-bottom: 10px; object-fit: cover; }
    nav { display: flex; justify-content: center; background: #10b981; }
    nav button { padding: 10px 20px; border: none; background: #10b981; color: white; cursor: pointer; font-family: 'Times New Roman', Times, serif; }
    nav button:hover { background: #059669; }
    .tab { display: none; padding: 20px; background: #f0fdf4; border-radius: 8px; margin: 10px; }
    .active { display: block; }
    input[type="text"], input[type="number"] { padding: 12px 16px; margin: 8px 0; border: 2px solid #d1d5db; border-radius: 8px; font-size: 16px; width: 200px; box-sizing: border-box; }
    input[type="text"]:focus, input[type="number"]:focus { outline: none; border-color: #10b981; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1); transform: translateY(-1px); }
    button:not(nav button) { padding: 12px 24px; margin: 8px 4px; border: none; background: #10b981; color: white; cursor: pointer; border-radius: 8px; font-size: 16px; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
    button:not(nav button):hover { background: #059669; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #333; padding: 8px; text-align: center; }
    footer { text-align: center; padding: 15px; background: #065f46; color: white; position: fixed; bottom: 0; width: 100%; font-size: 14px; }
    .gallery-container { position: relative; max-width: 100%; margin: 20px 0; background: #f0fdf4; border-radius: 8px; overflow: hidden; padding: 10px; }
    .gallery-wrapper { overflow: hidden; width: 100%; border-radius: 6px; }
    .gallery-track { display: flex; transition: transform 0.3s ease-in-out; width: 400%; gap: 10px; }
    .gallery-slide { min-width: 25%; width: 25%; height: auto; max-height: 400px; object-fit: contain; display: block; border-radius: 6px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
    .gallery-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(16, 185, 129, 0.9); color: white; border: none; padding: 12px; cursor: pointer; font-size: 20px; z-index: 10; border-radius: 50%; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
    .gallery-btn:hover { background: #059669; transform: translateY(-50%) scale(1.1); }
    .prev { left: 15px; }
    .next { right: 15px; }
    .mpesa-details { margin: 15px 0; padding: 15px; background: #e6fffa; border-radius: 8px; border: 1px solid #10b981; }
    .mpesa-details h3 { margin: 0 0 10px; font-size: 18px; color: #047857; }
    .mpesa-details p { margin: 5px 0; font-size: 16px; }
    .mpesa-details .copy-btn { padding: 6px 12px; font-size: 14px; margin-left: 10px; background: #047857; }
    .mpesa-details .copy-btn:hover { background: #059669; }
    @media (max-width: 768px) { .gallery-slide { max-height: 300px; } .gallery-btn { padding: 8px; font-size: 18px; width: 40px; height: 40px; } input[type="text"], input[type="number"] { width: 100%; max-width: 250px; } .gallery-track { gap: 5px; } .mpesa-details { padding: 10px; } .mpesa-details .copy-btn { margin-top: 5px; } }
  </style>
</head>
<body>
  <header>
    <img src="images/profile.jpg" alt="Club Profile Picture">
    <h1>IRINDIRO FOOTBALL CLUB</h1>
  </header>

  <nav>
    <button onclick="openTab('about')">About</button>
    <button onclick="openTab('registration')">Registration</button>
    <button onclick="openTab('contributions')">Contributions</button>
  </nav>

  <div id="about" class="tab active">
    <h2>About IRINDIRO FC</h2>
    <p>Founded in 1980, Irindiro Football Club has grown into one of the strongest community clubs in the region. The club has proudly won multiple local tournaments, including the Governor's Cup and other district championships, bringing pride and unity to the community.</p>
    <div class="gallery-container">
      <button class="gallery-btn prev" onclick="changeSlide(-1)">‹</button>
      <div class="gallery-wrapper">
        <div class="gallery-track" id="galleryTrack">
          <img src="images/squad1.jpg" alt="Squad Picture 1" class="gallery-slide">
          <img src="images/squad2.jpg" alt="Squad Picture 2" class="gallery-slide">
          <img src="images/squad3.jpg" alt="Squad Picture 3" class="gallery-slide">
          <img src="images/squad4.jpg" alt="Squad Picture 4" class="gallery-slide">
        </div>
      </div>
      <button class="gallery-btn next" onclick="changeSlide(1)">›</button>
    </div>
  </div>

  <div id="registration" class="tab">
    <h2>Player Registration</h2>
    <p>Enter player name and contribution:</p>
    <input type="text" id="playerName" placeholder="Player Name">
    <input type="number" id="playerAmount" placeholder="Amount">
    <button onclick="registerPlayer()">Register</button>
    <h3>Registered Players</h3>
    <table>
      <thead><tr><th>Player Name</th><th>Amount</th><th>Date</th></tr></thead>
      <tbody id="playerList"><tr><td colspan="3">Loading players...</td></tr></tbody>
    </table>
  </div>

  <div id="contributions" class="tab">
    <h2>Club Contributions</h2>
    <p>Enter contributor name and amount:</p>
    <input type="text" id="contribName" placeholder="Name">
    <input type="number" id="contribAmount" placeholder="Amount">
    <button onclick="addContribution()">Contribute</button>
    <div class="mpesa-details">
      <h3>Make Payment via M-Pesa</h3>
      <p><strong>Name:</strong> LAMAXON MUGURI</p>
      <p><strong>Number:</strong> <span id="mpesaNumber">0708884863</span>
        <button onclick="copyMpesaNumber()" class="copy-btn">Copy</button></p>
    </div>
    <h3>Contribution List</h3>
    <table>
      <thead><tr><th>Name</th><th>Amount</th><th>Date</th></tr></thead>
      <tbody id="contribList"><tr><td colspan="3">Loading contributions...</td></tr></tbody>
    </table>
    <h3>Total Contributions: <span id="total">0</span></h3>
  </div>

  <footer>© 2025 IRINDIRO FOOTBALL CLUB | Powered by Supabase</footer>

  <script>
    // Load Supabase from reliable CDN
    (function() {
      const script = document.createElement('script');
      script.src = 'https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.js';
      script.onload = function() {
        console.log('✅ Supabase library loaded');
        initializeApp();
      };
      script.onerror = function() {
        console.error('❌ Supabase library failed to load');
        alert('Database library failed to load - check your internet connection');
      };
      document.head.appendChild(script);
    })();

    function initializeApp() {
      if (typeof supabase === 'undefined') {
        console.error('❌ Supabase not available');
        return;
      }

      const supabaseUrl = 'https://qguvmhnqorafjauogi.supabase.co';
      const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFndXZtaG5xb3JhZmphdW9naSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzI2NTYxMjAwLCJleHAiOjIwNDIxMzcyMDB9.ZzZ0W2X4Q5z1p3q8r7t9u0v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0y1z2';
      
      window.supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
      console.log('✅ Supabase client created');

      // Now define all functions
      defineFunctions();
      loadInitialData();
    }

    function defineFunctions() {
      window.openTab = function(tabId) {
        console.log('🗂️ Opening tab:', tabId);
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        
        if (tabId === 'registration') loadPlayers();
        else if (tabId === 'contributions') loadContributions();
      };

      window.registerPlayer = function() {
        const name = document.getElementById("playerName").value.trim();
        const amount = parseInt(document.getElementById("playerAmount").value);

        if (!name || isNaN(amount) || amount < 50) {
          alert("Enter valid name and amount (50 or greater).");
          return;
        }

        window.supabaseClient
          .from('players')
          .insert([{ name, amount }])
          .then(({ error }) => {
            if (error) {
              console.error('Registration error:', error);
              alert('Error registering player: ' + error.message);
            } else {
              alert('Player registered successfully!');
              document.getElementById("playerName").value = "";
              document.getElementById("playerAmount").value = "";
              loadPlayers();
            }
          });
      };

      window.addContribution = function() {
        const name = document.getElementById("contribName").value.trim();
        const amount = parseInt(document.getElementById("contribAmount").value);

        if (!name || isNaN(amount) || amount < 20) {
          alert("Enter valid name and amount (20 or more).");
          return;
        }

        window.supabaseClient
          .from('contributions')
          .insert([{ name, amount }])
          .then(({ error }) => {
            if (error) {
              console.error('Contribution error:', error);
              alert('Error adding contribution: ' + error.message);
            } else {
              alert('Contribution added successfully!');
              document.getElementById("contribName").value = "";
              document.getElementById("contribAmount").value = "";
              loadContributions();
            }
          });
      };

      window.copyMpesaNumber = function() {
        const number = document.getElementById("mpesaNumber").textContent;
        navigator.clipboard.writeText(number).then(() => {
          alert("M-Pesa number copied to clipboard!");
        }).catch(() => {
          alert("Failed to copy. Please copy manually: 0708884863");
        });
      };

      window.changeSlide = function(direction) {
        currentSlide += direction;
        if (currentSlide >= slidesCount) currentSlide = 0;
        if (currentSlide < 0) currentSlide = slidesCount - 1;
        const track = document.getElementById('galleryTrack');
        if (track) track.style.transform = `translateX(-${currentSlide * 25}%)`;
      };

      // Load functions
      window.loadPlayers = function() {
        window.supabaseClient
          .from('players')
          .select('*')
          .order('created_at', { ascending: false })
          .then(({ data: players, error }) => {
            const tbody = document.getElementById("playerList");
            if (error) {
              tbody.innerHTML = '<tr><td colspan="3">Error loading players.</td></tr>';
              return;
            }
            if (players && players.length > 0) {
              tbody.innerHTML = players.map(player => `
                <tr><td>${player.name}</td><td>${player.amount}</td><td>${new Date(player.created_at).toLocaleDateString()}</td></tr>
              `).join('');
            } else {
              tbody.innerHTML = '<tr><td colspan="3">No players registered yet.</td></tr>';
            }
          });
      };

      window.loadContributions = function() {
        window.supabaseClient
          .from('contributions')
          .select('*')
          .order('created_at', { ascending: false })
          .then(({ data: contributions, error }) => {
            const tbody = document.getElementById("contribList");
            let total = 0;
            if (error) {
              tbody.innerHTML = '<tr><td colspan="3">Error loading contributions.</td></tr>';
              document.getElementById("total").textContent = 'Error';
              return;
            }
            if (contributions && contributions.length > 0) {
              tbody.innerHTML = contributions.map(contrib => {
                total += contrib.amount;
                return `<tr><td>${contrib.name}</td><td>${contrib.amount}</td><td>${new Date(contrib.created_at).toLocaleDateString()}</td></tr>`;
              }).join('');
              document.getElementById("total").textContent = total;
            } else {
              tbody.innerHTML = '<tr><td colspan="3">No contributions yet.</td></tr>';
              document.getElementById("total").textContent = 0;
            }
          });
      };
    }

    function loadInitialData() {
      setTimeout(() => {
        loadContributions();
        loadPlayers();
      }, 1000);
    }

    // Global variables for gallery
    let currentSlide = 0;
    const slidesCount = 4;
  </script>
</body>
</html>
